#
# Copyright TE-FOOD International Corp., All Rights Reserved.
#

version: '3'

#volumes:
#    peer1.platinum.masternodes.${NETWORK}.foodchain.te-food.com:
#    peer2.platinum.masternodes.${NETWORK}.foodchain.te-food.com:
#    peer3.platinum.masternodes.${NETWORK}.foodchain.te-food.com:
#    peer4.platinum.masternodes.${NETWORK}.foodchain.te-food.com:
#    peer5.platinum.masternodes.${NETWORK}.foodchain.te-food.com:
#    peer6.platinum.masternodes.${NETWORK}.foodchain.te-food.com:

networks:
    swarmnet:
        external:
            name: ${NETWORK}

services:
    
    peer1:
        image: hyperledger/fabric-peer:$IMAGE_TAG
        hostname: peer1.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        networks:
            swarmnet:
                aliases:
                    - peer1.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        volumes:
            - /var/run/:/host/var/run/
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer1.platinum.masternodes.${NETWORK}.foodchain.te-food.com/msp:/etc/hyperledger/fabric/msp
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer1.platinum.masternodes.${NETWORK}.foodchain.te-food.com/tls:/etc/hyperledger/fabric/tls
            - ${DATA}/masternodes/platinum/peer1:/var/hyperledger/production
        environment:
            - CORE_PEER_ID=peer1.platinum.masternodes.${NETWORK}.foodchain.te-food.com
            - CORE_PEER_ADDRESS=peer1.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_BOOTSTRAP=peer1.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer1.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_LOCALMSPID=PlatinumMSP
            - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
            - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${NETWORK}
            - CORE_LOGGING_LEVEL=INFO
            #- CORE_LOGGING_LEVEL=DEBUG
            - CORE_PEER_TLS_ENABLED=true
            - CORE_PEER_GOSSIP_USELEADERELECTION=true
            - CORE_PEER_GOSSIP_ORGLEADER=false
            - CORE_PEER_PROFILE_ENABLED=true
            - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
            - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
            - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
        working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
        command: peer node start
        deploy:                                                                                                                                                                                                
            replicas: 1
            placement:
                constraints: [node.hostname == $SWARM_MANAGER]
            restart_policy:
                condition: any 
                delay: 5s
                max_attempts: 5

    peer2:
        image: hyperledger/fabric-peer:$IMAGE_TAG
        hostname: peer2.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        networks:
            swarmnet:
                aliases:
                    - peer2.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        volumes:
            - /var/run/:/host/var/run/
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer2.platinum.masternodes.${NETWORK}.foodchain.te-food.com/msp:/etc/hyperledger/fabric/msp
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer2.platinum.masternodes.${NETWORK}.foodchain.te-food.com/tls:/etc/hyperledger/fabric/tls
            - ${DATA}/masternodes/platinum/peer2:/var/hyperledger/production
        environment:
            - CORE_PEER_ID=peer2.platinum.masternodes.${NETWORK}.foodchain.te-food.com
            - CORE_PEER_ADDRESS=peer2.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_BOOTSTRAP=peer2.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer2.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_LOCALMSPID=PlatinumMSP
            - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
            - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${NETWORK}
            - CORE_LOGGING_LEVEL=INFO
            #- CORE_LOGGING_LEVEL=DEBUG
            - CORE_PEER_TLS_ENABLED=true
            - CORE_PEER_GOSSIP_USELEADERELECTION=true
            - CORE_PEER_GOSSIP_ORGLEADER=false
            - CORE_PEER_PROFILE_ENABLED=true
            - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
            - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
            - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
        working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
        command: peer node start
        deploy:                     
            replicas: 1
            placement:
                constraints: [node.hostname == mainnet-worker-vultr]
            restart_policy:
                condition: any 
                delay: 5s
                max_attempts: 5

    peer3:
        image: hyperledger/fabric-peer:$IMAGE_TAG
        hostname: peer3.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        networks:
            swarmnet:
                aliases:
                    - peer3.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        volumes:
            - /var/run/:/host/var/run/
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer3.platinum.masternodes.${NETWORK}.foodchain.te-food.com/msp:/etc/hyperledger/fabric/msp
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer3.platinum.masternodes.${NETWORK}.foodchain.te-food.com/tls:/etc/hyperledger/fabric/tls
            - ${DATA}/masternodes/platinum/peer3:/var/hyperledger/production
        environment:
            - CORE_PEER_ID=peer3.platinum.masternodes.${NETWORK}.foodchain.te-food.com
            - CORE_PEER_ADDRESS=peer3.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_BOOTSTRAP=peer3.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer3.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_LOCALMSPID=PlatinumMSP
            - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
            - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${NETWORK}
            - CORE_LOGGING_LEVEL=INFO
            #- CORE_LOGGING_LEVEL=DEBUG
            - CORE_PEER_TLS_ENABLED=true
            - CORE_PEER_GOSSIP_USELEADERELECTION=true
            - CORE_PEER_GOSSIP_ORGLEADER=false
            - CORE_PEER_PROFILE_ENABLED=true
            - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
            - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
            - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
        working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
        command: peer node start
        deploy:                     
            replicas: 1
            placement:
                constraints: [node.hostname == $SWARM_MANAGER]
            restart_policy:
                condition: any 
                delay: 5s
                max_attempts: 5

    peer4:
        image: hyperledger/fabric-peer:$IMAGE_TAG
        hostname: peer4.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        networks:
            swarmnet:
                aliases:
                    - peer4.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        volumes:
            - /var/run/:/host/var/run/
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer4.platinum.masternodes.${NETWORK}.foodchain.te-food.com/msp:/etc/hyperledger/fabric/msp
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer4.platinum.masternodes.${NETWORK}.foodchain.te-food.com/tls:/etc/hyperledger/fabric/tls
            - ${DATA}/masternodes/platinum/peer4:/var/hyperledger/production
        environment:
            - CORE_PEER_ID=peer4.platinum.masternodes.${NETWORK}.foodchain.te-food.com
            - CORE_PEER_ADDRESS=peer4.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_BOOTSTRAP=peer4.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer4.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_LOCALMSPID=PlatinumMSP
            - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
            - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${NETWORK}
            - CORE_LOGGING_LEVEL=INFO
            #- CORE_LOGGING_LEVEL=DEBUG
            - CORE_PEER_TLS_ENABLED=true
            - CORE_PEER_GOSSIP_USELEADERELECTION=true
            - CORE_PEER_GOSSIP_ORGLEADER=false
            - CORE_PEER_PROFILE_ENABLED=true
            - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
            - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
            - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
        working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
        command: peer node start
        deploy:                     
            replicas: 0
            placement:
                constraints: [node.hostname == 136-144-212-64]
            restart_policy:
                condition: any 
                delay: 5s
                max_attempts: 5

    peer5:
        image: hyperledger/fabric-peer:$IMAGE_TAG
        hostname: peer5.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        networks:
            swarmnet:
                aliases:
                    - peer5.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        volumes:
            - /var/run/:/host/var/run/
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer5.platinum.masternodes.${NETWORK}.foodchain.te-food.com/msp:/etc/hyperledger/fabric/msp
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer5.platinum.masternodes.${NETWORK}.foodchain.te-food.com/tls:/etc/hyperledger/fabric/tls
            - ${DATA}/masternodes/platinum/peer5:/var/hyperledger/production
        environment:
            - CORE_PEER_ID=peer5.platinum.masternodes.${NETWORK}.foodchain.te-food.com
            - CORE_PEER_ADDRESS=peer5.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_BOOTSTRAP=peer5.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer5.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_LOCALMSPID=PlatinumMSP
            - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
            - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${NETWORK}
            - CORE_LOGGING_LEVEL=INFO
            #- CORE_LOGGING_LEVEL=DEBUG
            - CORE_PEER_TLS_ENABLED=true
            - CORE_PEER_GOSSIP_USELEADERELECTION=true
            - CORE_PEER_GOSSIP_ORGLEADER=false
            - CORE_PEER_PROFILE_ENABLED=true
            - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
            - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
            - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
        working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
        command: peer node start
        deploy:                     
            replicas: 0
            placement:
                constraints: [node.hostname == lg-mainnet]
            restart_policy:
                condition: any 
                delay: 5s
                max_attempts: 5

    peer6:
        image: hyperledger/fabric-peer:$IMAGE_TAG
        hostname: peer6.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        networks:
            swarmnet:
                aliases:
                    - peer6.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        volumes:
            - /var/run/:/host/var/run/
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer6.platinum.masternodes.${NETWORK}.foodchain.te-food.com/msp:/etc/hyperledger/fabric/msp
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer6.platinum.masternodes.${NETWORK}.foodchain.te-food.com/tls:/etc/hyperledger/fabric/tls
            - ${DATA}/masternodes/platinum/peer6:/var/hyperledger/production
        environment:
            - CORE_PEER_ID=peer6.platinum.masternodes.${NETWORK}.foodchain.te-food.com
            - CORE_PEER_ADDRESS=peer6.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_BOOTSTRAP=peer6.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer6.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_LOCALMSPID=PlatinumMSP
            - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
            - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${NETWORK}
            - CORE_LOGGING_LEVEL=INFO
            #- CORE_LOGGING_LEVEL=DEBUG
            - CORE_PEER_TLS_ENABLED=true
            - CORE_PEER_GOSSIP_USELEADERELECTION=true
            - CORE_PEER_GOSSIP_ORGLEADER=false
            - CORE_PEER_PROFILE_ENABLED=true
            - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
            - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
            - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
        working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
        command: peer node start
        deploy:                     
            replicas: 0
            placement:
                constraints: [node.hostname == loc-te-food-1]
            restart_policy:
                condition: any 
                delay: 5s
                max_attempts: 5

    peer7:
        image: hyperledger/fabric-peer:$IMAGE_TAG
        hostname: peer7.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        networks:
            swarmnet:
                aliases:
                    - peer7.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        volumes:
            - /var/run/:/host/var/run/
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer7.platinum.masternodes.${NETWORK}.foodchain.te-food.com/msp:/etc/hyperledger/fabric/msp
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer7.platinum.masternodes.${NETWORK}.foodchain.te-food.com/tls:/etc/hyperledger/fabric/tls
            - ${DATA}/masternodes/platinum/peer7:/var/hyperledger/production
        environment:
            - CORE_PEER_ID=peer7.platinum.masternodes.${NETWORK}.foodchain.te-food.com
            - CORE_PEER_ADDRESS=peer7.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_BOOTSTRAP=peer7.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer7.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_LOCALMSPID=PlatinumMSP
            - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
            - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${NETWORK}
            - CORE_LOGGING_LEVEL=INFO
            #- CORE_LOGGING_LEVEL=DEBUG
            - CORE_PEER_TLS_ENABLED=true
            - CORE_PEER_GOSSIP_USELEADERELECTION=true
            - CORE_PEER_GOSSIP_ORGLEADER=false
            - CORE_PEER_PROFILE_ENABLED=true
            - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
            - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
            - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
        working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
        command: peer node start
        deploy:                     
            replicas: 0
            placement:
                constraints: [node.hostname == mainnet-worker-contabo]
            restart_policy:
                condition: any 
                delay: 5s
                max_attempts: 5

    peer8:
        image: hyperledger/fabric-peer:$IMAGE_TAG
        hostname: peer8.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        networks:
            swarmnet:
                aliases:
                    - peer8.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        volumes:
            - /var/run/:/host/var/run/
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer8.platinum.masternodes.${NETWORK}.foodchain.te-food.com/msp:/etc/hyperledger/fabric/msp
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer8.platinum.masternodes.${NETWORK}.foodchain.te-food.com/tls:/etc/hyperledger/fabric/tls
            - ${DATA}/masternodes/platinum/peer8:/var/hyperledger/production
        environment:
            - CORE_PEER_ID=peer8.platinum.masternodes.${NETWORK}.foodchain.te-food.com
            - CORE_PEER_ADDRESS=peer8.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_BOOTSTRAP=peer8.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer8.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_LOCALMSPID=PlatinumMSP
            - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
            - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${NETWORK}
            - CORE_LOGGING_LEVEL=INFO
            #- CORE_LOGGING_LEVEL=DEBUG
            - CORE_PEER_TLS_ENABLED=true
            - CORE_PEER_GOSSIP_USELEADERELECTION=true
            - CORE_PEER_GOSSIP_ORGLEADER=false
            - CORE_PEER_PROFILE_ENABLED=true
            - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
            - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
            - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
        working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
        command: peer node start
        deploy:                     
            replicas: 0
            placement:
                constraints: [node.hostname == mainnet-worker-contabo]
            restart_policy:
                condition: any 
                delay: 5s
                max_attempts: 5

    peer9:
        image: hyperledger/fabric-peer:$IMAGE_TAG
        hostname: peer9.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        networks:
            swarmnet:
                aliases:
                    - peer9.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        volumes:
            - /var/run/:/host/var/run/
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer9.platinum.masternodes.${NETWORK}.foodchain.te-food.com/msp:/etc/hyperledger/fabric/msp
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer9.platinum.masternodes.${NETWORK}.foodchain.te-food.com/tls:/etc/hyperledger/fabric/tls
            - ${DATA}/masternodes/platinum/peer9:/var/hyperledger/production
        environment:
            - CORE_PEER_ID=peer9.platinum.masternodes.${NETWORK}.foodchain.te-food.com
            - CORE_PEER_ADDRESS=peer9.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_BOOTSTRAP=peer9.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer9.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_LOCALMSPID=PlatinumMSP
            - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
            - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${NETWORK}
            - CORE_LOGGING_LEVEL=INFO
            #- CORE_LOGGING_LEVEL=DEBUG
            - CORE_PEER_TLS_ENABLED=true
            - CORE_PEER_GOSSIP_USELEADERELECTION=true
            - CORE_PEER_GOSSIP_ORGLEADER=false
            - CORE_PEER_PROFILE_ENABLED=true
            - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
            - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
            - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
        working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
        command: peer node start
        deploy:                     
            replicas: 0
            placement:
                constraints: [node.hostname == mainnet-worker-contabo]
            restart_policy:
                condition: any 
                delay: 5s
                max_attempts: 5

    peer10:
        image: hyperledger/fabric-peer:$IMAGE_TAG
        hostname: peer10.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        networks:
            swarmnet:
                aliases:
                    - peer10.platinum.masternodes.${NETWORK}.foodchain.te-food.com
        volumes:
            - /var/run/:/host/var/run/
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer10.platinum.masternodes.${NETWORK}.foodchain.te-food.com/msp:/etc/hyperledger/fabric/msp
            - ${CRYPTO}/peerOrganizations/platinum.masternodes.${NETWORK}.foodchain.te-food.com/peers/peer10.platinum.masternodes.${NETWORK}.foodchain.te-food.com/tls:/etc/hyperledger/fabric/tls
            - ${DATA}/masternodes/platinum/peer10:/var/hyperledger/production
        environment:
            - CORE_PEER_ID=peer10.platinum.masternodes.${NETWORK}.foodchain.te-food.com
            - CORE_PEER_ADDRESS=peer10.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_BOOTSTRAP=peer10.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer10.platinum.masternodes.${NETWORK}.foodchain.te-food.com:7051
            - CORE_PEER_LOCALMSPID=PlatinumMSP
            - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
            - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${NETWORK}
            - CORE_LOGGING_LEVEL=INFO
            #- CORE_LOGGING_LEVEL=DEBUG
            - CORE_PEER_TLS_ENABLED=true
            - CORE_PEER_GOSSIP_USELEADERELECTION=true
            - CORE_PEER_GOSSIP_ORGLEADER=false
            - CORE_PEER_PROFILE_ENABLED=true
            - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
            - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
            - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
        working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
        command: peer node start
        deploy:                     
            replicas: 0
            placement:
                constraints: [node.hostname == mainnet-worker-contabo]
            restart_policy:
                condition: any 
                delay: 5s
                max_attempts: 5

